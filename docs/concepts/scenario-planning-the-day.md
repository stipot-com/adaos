# Сценарий 1. "Планирование дня"

**История изменений**

| **Дата изменения** | **Версия** | **Описание изменений** | **Автор изменений** |
|--------------------|------------|------------------------|---------------------|
| 09.11.2025         | v0.0.1     | Планирование дня       | Кузьмин Е.О.        |

---

| **№**      | **User Story** |
|------------|----------------|
| US_1.2     | Планирование дня |

---

**Use Case**

| **Наименование**       | **Описание**                                                                 |
|------------------------|-----------------------------------------------------------------------------|
| Название сценария      | "Планирование дня"                                                          |
| Цель                   | Сформировать и озвучить персонализированный план дня, предложить оптимизации маршрутов и времени, получить подтверждение или внести корректировки, перевести систему в режим ожидания следующей команды. |
| Участники (акторы)     | - Пользователь<br>- AdaOS                                                  |
| Предусловие            | - Система ADAos активна и находится в режиме [STATUS: AWAITING_USER_CHOICE] после сценария "Доброе утро"<br>- Пользователь выбрал хотя бы один из вариантов (погода/новости/дела) или пропустил выбор<br>- Модули календаря, навигации, задач и ИИ-планировщика активны<br>- Микрофон и динамики функционируют<br>- Доступ к актуальным данным о трафике и погоде |
| Триггер                | - Завершение сценария "Доброе утро" (пользователь ответил на предложение или истёк таймер 10 сек)<br>- Или пользователь явно говорит: "Что у меня сегодня?" / "Спланируй день" |
| Постусловие            | - Система переходит в режим [STATUS: AWAITING_USER_CONFIRMATION] или [STATUS: READY]<br>- В терминале отображается статус [STATUS: AWAITING_USER_CONFIRMATION]<br>- Активен таймер ожидания ответа (15 секунд)<br>- План дня сохранён в временном буфере для возможных правок |
| Результат              | - Пользователь получил краткий обзор расписания с предложениями по оптимизации<br>- Система готова к обработке подтверждений, правок или новой команды<br>- При отсутствии ответа — возврат в базовое состояние ожидания |

---

**Основной сценарий**

1. **Триггер**: Пользователь завершил сценарий "Доброе утро" (например, сказал "Погоду, пожалуйста")
2. AdaOS завершает выполнение выбранного запроса (озвучивает погоду)
3. AdaOS анализирует календарь на текущий день
4. AdaOS воспроизводит переходный звуковой сигнал (мягкий "ding")
5. AdaOS произносит: "Хорошо, погода ясная. Теперь о вашем дне. У вас: — 10:00 — встреча с командой в офисе — 14:30 — дедлайн по отчёту — 18:00 — тренировка в зале на Ленина, 12. Рекомендую выехать в 9:35 — пробки на выезде из района. Добавить напоминание за 15 минут?"
6. AdaOS выводит в терминал:
   - [STATUS: AWAITING_USER_CONFIRMATION]
   - [PLAN: 09:35 — выезд | 10:00 — встреча | 14:30 — отчёт | 18:00 — тренировка]
7. AdaOS активирует таймер ожидания (15 сек)

---

**Альтернативные сценарии**

**Альтернативный сценарий 1: Пользователь подтверждает план**
- Пользователь: "Да, добавь напоминание. И кофе в 11:30"
- AdaOS: "Отлично. Напоминание за 15 минут до выезда — установлено. Кофе-брейк в 11:30 — добавлен между встречей и отчётом."
- AdaOS обновляет план и сохраняет в календарь
- AdaOS: "План готов. Что дальше?"
- AdaOS выводит: [STATUS: READY]

**Альтернативный сценарий 2: Пользователь вносит правки**
- Пользователь: "Перенеси тренировку на 19:00"
- AdaOS: "Тренировка перенесена на 19:00. Зал подтвердил свободное окно. Обновить?"
- Пользователь: "Да"
- AdaOS: "Готово. План обновлён."
- Переход в [STATUS: READY]

**Альтернативный сценарий 3: Пустое расписание**
- AdaOS: "На сегодня у вас нет запланированных дел. Хотите добавить задачу или встречу?"
- Пользователь: "Напомни купить продукты в 17:00"
- AdaOS: "Задача 'купить продукты' добавлена на 17:00. Напоминание за 30 минут?"
- Переход в режим подтверждения

**Альтернативный сценарий 4: Отсутствие ответа (таймаут)**
- Прошло 15 секунд без ответа
- AdaOS: "Похоже, вы заняты. План сохранён в фоне. Обращайтесь, когда будет удобно."
- AdaOS возвращается в [STATUS: READY]
- План остаётся доступным по команде "Покажи план"

**Альтернативный сценарий 5: Ошибка доступа к календарю**
- AdaOS не может получить данные календаря
- AdaOS: "Не могу загрузить ваш календарь. Проверьте подключение или права доступа."
- AdaOS выводит: [STATUS: CALENDAR_ACCESS_ERROR]
- Предлагает: "Хотите создать план вручную?"
- Переход в режим ручного ввода задач

```mermaid
sequenceDiagram
    title Обработка команды "Планирование дня"
    
    actor User as Пользователь
    participant Terminal
    participant System as ADAos
    participant Cal as Календарь
    participant Nav as Навигация
    participant AI as AI-Планировщик

    Note over User,AI: == Основной поток: Планирование дня ==
    
    autonumber
    
    User->>System: [Триггер] Завершение "Доброе утро" (или: "Что у меня сегодня?")
    System->>System: Завершает предыдущий запрос (например, озвучивает погоду)
    System->>Cal: Запросить события на сегодня
    Cal-->>System: 10:00 — встреча, 14:30 — отчёт, 18:00 — тренировка
    System->>Nav: Проверить трафик до офиса
    Nav-->>System: Выезд в 9:35, пробки +25 мин
    System->>AI: Сформировать план
    AI-->>System: Рекомендация: напоминание за 15 мин
    System->>System: Воспроизводит сигнал (ding)
    System->>User: "Хорошо, погода ясная. Ваш день: — 10:00 — встреча — 14:30 — отчёт — 18:00 — тренировка. Выезд в 9:35. Добавить напоминание?"
    System->>Terminal: [STATUS: AWAITING_USER_CONFIRMATION]<br/>[PLAN: 09:35 — выезд | 10:00 — встреча | ...]
    System->>System: Таймер: 15 сек

    alt Подтверждение + добавление
        User->>System: "Да, добавь. И кофе в 11:30"
        System->>Cal: Добавить: напоминание 9:20 + кофе 11:30
        Cal-->>System: Подтверждено
        System->>User: "Готово. Кофе в 11:30 добавлен."
        System->>User: "План готов. Что дальше?"
        System->>Terminal: [STATUS: READY]
    else Правка плана
        User->>System: "Перенеси тренировку на 19:00"
        System->>Cal: Обновить: тренировка → 19:00
        Cal-->>System: Обновлено
        System->>User: "Тренировка перенесена. План обновлён."
        System->>Terminal: [STATUS: READY]
    else Пустое расписание
        Cal-->>System: Нет событий
        System->>User: "Сегодня дел нет. Добавить задачу?"
        User->>System: "Напомни купить продукты в 17:00"
        System->>Cal: Добавить: "Продукты" → 17:00
        Cal-->>System: Добавлено
        System->>User: "Задача добавлена. Напоминание за 30 мин?"
        System->>Terminal: [STATUS: AWAITING_USER_CONFIRMATION]
    else Таймаут (15 сек)
        System->>System: Таймер истёк
        System->>User: "План сохранён. Обращайтесь, когда удобно."
        System->>Terminal: [STATUS: READY]
    else Ошибка календаря
        Cal-->>System: Ошибка доступа
        System->>User: "Не могу загрузить календарь. Проверьте сеть."
        System->>Terminal: [STATUS: CALENDAR_ACCESS_ERROR]
        System->>User: "Создать план вручную?"
        System->>System: Режим ручного ввода
    end
```
